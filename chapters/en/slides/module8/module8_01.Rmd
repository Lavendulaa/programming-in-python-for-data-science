---
params:
  dynamictitle: "module8_01"
title: "`r params$dynamictitle`"
output: 
  md_document:
    variant: gfm
---


```{r setup, include=FALSE}
## DO NOT FORGET TO CHANGE THIS ACCORDINGLY 
library(rmarkdown)
# MAke sure you are updating your title 
knitr::opts_chunk$set(echo = TRUE,
                      base.dir = ".", 
                      base.url = "/",
                      fig.path = paste("../../static/module8/", params$dynamictitle,"/", sep = ""))

knitr_opts <- knitr_options( opts_knit = NULL,
                             opts_chunk = NULL,
                             knit_hooks = NULL,
                             opts_hooks = NULL,
                             opts_template = NULL)
md_document_custom <- md_document(variant = "gfm")
output_format(knitr = knitr_opts,
              pandoc = NULL,
              base_format = md_document_custom)
library(reticulate)
Sys.setenv(RETICULATE_PYTHON = "/usr/local/bin/python3")
#use_python("/usr/local/bin/python3", required=T)
```


```{python include=FALSE}
import pandas as pd
import numpy as np
import altair as alt
from altair_saver import save
pd.set_option('display.width', 350)

np.set_printoptions(linewidth=400)

pd.set_option('display.max_columns', 50)
pd.set_option('display.max_rows', 15)
cereal = pd.read_csv('cereal.csv')
```

type: slides


# NumPy and 1D Arrays

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

Although we have not formally introduced you to NumPy, the name may sound familiar since we've been subtly hinting at its existence for a little while now. In the last Module, we've had you import this library for practice. 

```{python}
import numpy as np
```


So what is NumPy? 


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## What is NumPy?

The name NumPy is derived from **"Numerical Python extensions"**.

NumPy is a Python library used primarily for computing involving numbers. It is especially useful as it provides a multidimensional array object, called an ***array***.

In addition, NumPy also offers numerous other mathematical functions used in the domain of Linear Algebra and Calculus.

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## So What is an Array? 

A NumPy array is somewhat like a list:

```{python}
my_list = [1, 2, 3, 4, 5]
my_list
```

```{python}
my_array = np.array((1, 2, 3, 4, 5))
my_array
```

And arrays are considered their own data type:

```{python}
type(my_array)
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

However, we'll start to see that although lists and arrays appear quite similar, they have some key differences. 
A list can contain multiple data types: 

```{python}
my_list = [1,"hi"]
```

An array cannot: 
```{python}
my_array = np.array((1, "hi"))
my_array
```
In this case, `1` was converted to `'1'` which is now a string. 


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Creating 1D Arrays 

We can make them from lists as well as tuples:

```{python}
my_array = np.array([1, 2, 3, 4])
my_array
```

There are also several built-in NumPy functions that create different arrays with patterns and requirements.

`np.zeros()` will create an array containing `0` for each element and the input argument specifies the size:
```{python}
np.zeros(10)
```
Similarly, `np.ones()` does the same thing except with an array of elements with `1` values:

```{python}
np.ones(4)
```



Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---


`np.arange()` similarly to `range()` can take 1, 2 or 3 input arguments and will produce an array in a similar way that `range()` produces a sequence. 

```{python}
np.arange(5)
```

If there are 3 input arguments, the first 2 are where the interval values start and stop respectively and the third argument gives the step sizr between values: 
```{python}
np.arange(0, 10, 2) 
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

`np.linspace()` will produce an array containing the number of elements specified by the 3rd argument's value, containing values between the first 2 arguments values. 
Example: 20, equally spaced values from 1 to 5:
```{python}
np.linspace(1,5,20)
```
The elements in `np.linspace()` arrays are defaulted to type `float`.    
We can also produce an array with random values using `np.random.rand()`.          
Example: Random numbers uniformly distributed from 0 to 1
```{python}
np.random.rand(5) 
```


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Elementwise operations 

We discussed that array and lists are similar but not quite the same. Arrays are design for convenience mathematically so  arrays operate in an elementwise manner. When we do operations, the operation is done to each element in the array. 

```{python}
array1 = np.ones(4)
array1
```

```{python}
array2 = array1 + 1
array2
```
```{python}
array1 + array2
```
```{python}
array1 * array2
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

This is much more convenient than using list. 

```{python}
list_1 = [ 1, 1, 1, 1]
```

We can't simply add 1 to list:

```{python eval=FALSE}
list_1 + 1
```

```out
TypeError: can only concatenate list (not "int") to list

Detailed traceback: 
  File "<string>", line 1, in <module>
```


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

If we wanted the same operations done with lists we would have to use a loop or list comprehension: 
```{python}
list_1 = [ 1, 1, 1, 1]

list_2 =  [elem + 1 for elem in list_1]
list_2
```

```{python}
list_3 = []

for index in range(len(list_1)):
  list_3.append(list_1[index] + list_2[index])
  
list_3
```




Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---
## Slicing and Indexing 1D Arrays 

When it comes to slicing, 1D arrays are sliced in the same manner that lists are.
```{python}
arr = np.arange(10)
arr
```

```{python}
arr[7]
```
The first value is included and the last value is excluded:
```{python}
arr[2:6]
```
To obtain elements from right to left, we use negative integers:
```{python}
arr[-1]
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Boolean Indexing 

Let's take a 1D array that consists of 10 elements. 
```{python}
grade_array = np.array([98,87,103, 92,67, 107, 78, 104, 85, 105])
grade_array
```
Remember that when we do most operations, it occurs in an element-wise manner:
```{python}
grade_array + 1000
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

Perhaps we are grading exams that contain bonus marks. The max possible allowed mark on the exam is 100% so we must cap the grades so any mark greater than 100 is set to 100. First we check which values are greater than 100. This produces an array containing Boolean  values which we name `threshold`:

```{python}
threshold = np.array([98,87,103, 92,67, 107, 78, 104, 85, 105]) > 100
threshold
```
The first and second elements are False since bother 98 and 87 and not larger than 100. However, the 3rd element is  true since 103 is larger than 100. 

We now can replace all those values that have a `True` Boolean, with a new value, in this case let's assign them a value of 100, the maximum possible allowed grade:

```{python}
grade_array[threshold] = 100
grade_array
```
Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

We could also shorten the whole process and avoided making `threshold` by using the following code:
```{python}
new_grade_array = np.array([98,87,103, 92,67, 107, 78, 104, 85, 105])
new_grade_array
```

```{python}
new_grade_array[new_grade_array > 100] = 100
new_grade_array
```
You'll notice that we use similar filtering square bracket notation that we did using pandas! 

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Why NumPy?

- Lists are often used with a similar purpose of arrays, but they are slow to process.

- Because of this, NumPy is used to create many other structures. 
- In fact, let's refresh ourselves on certain values in a dataframe:


```{python}
cereal.head()
```
Remember when we obtained the data type of a specific value in a dataframe? 
```{python}
type(cereal.loc[3,'calories'])
```
We obtained this `<class 'numpy.int64'>` which we originally ignored. What's going on here? 

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

--- 

We can actually convert an entire pandas column into an array pretty easily using `np.to_numpy()`: 
```{python}
cereal['calories'].to_numpy()
```
This is because a pandas dataframe is built off of a multidimensional (2D specifically) array! We will explain more about multi-dimensional arrays in the next set of slides.  


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

--- 

## NumPy Constants and Functions 

NumPy also offers an assortment of handy mathematical constants and functions. 

<img src='/module8/pi.gif'  alt="404 image"/>
```{python}
np.pi
```
<img src='/module8/inf.gif'  alt="404 image"/>
```{python}
np.inf
```
<img src='/module8/e.gif'  alt="404 image"/>
```{python}
np.e
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

--- 

## NumPy Functions 

`np.prod()` calculates the product of values in an array:
```{python}
np.prod([2, 3, 1])
```

And `np.diff()` calculates the difference between element (left element subtracted from the right element):
```{python}
np.diff([2, 5, 20])
```

Other functions such as `np.log()` or trigonometric ones are also available too: 

```{python}
np.log10(100)
```
The full list of mathematical functions are available at the <a href="https://numpy.org/doc/stable/reference/routines.math.html" target="_blank">NumPy website</a>.

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

# Let’s practice what we learned!

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />