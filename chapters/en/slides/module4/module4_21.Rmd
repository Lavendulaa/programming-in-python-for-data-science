---
params:
  dynamictitle: "module4_22"
title: "`r params$dynamictitle`"
output: 
  md_document:
    variant: gfm
---


```{r setup, include=FALSE}
## DO NOT FORGET TO CHANGE THIS ACCORDINGLY 
library(rmarkdown)
# MAke sure you are updating your title 
knitr::opts_chunk$set(echo = TRUE,
                      base.dir = ".", 
                      base.url = "/",
                      fig.path = paste("../../static/module4/", params$dynamictitle,"/", sep = ""))

knitr_opts <- knitr_options( opts_knit = NULL,
                             opts_chunk = NULL,
                             knit_hooks = NULL,
                             opts_hooks = NULL,
                             opts_template = NULL)
md_document_custom <- md_document(variant = "gfm")
output_format(knitr = knitr_opts,
              pandoc = NULL,
              base_format = md_document_custom)
library(reticulate)

```


```{python include=FALSE}
import pandas as pd
import numpy as np
pd.set_option('display.width', 350)

np.set_printoptions(linewidth=400)

pd.set_option('display.max_columns', 50)
pd.set_option('display.max_rows', 8)
cereal2 = pd.read_csv('cereal2.csv')
cereal2 = cereal2.loc[:,['name', 'mfr_type', 'type', 'calories', 'protein','fiber', 'fat',  'carbo',  'rating' ]].assign(hot=cereal2['type'] == 'Hot').drop(columns='type')
cereal = cereal2.assign(calories=cereal2['calories'].astype('str'))
```


type: slides


# Operations with Columns

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

We've just learned what Python values work with certain operations but what about dataframes?    
Let's take a look at our cereal dataframe once more: 

```{python}
cereal
```


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

It's always a good idea to see what column types we have before operating on them, since they may not be of the type we expect. 


```{python}
cereal.dtypes
```
In this case, we discover that the `calories` column is of dtype `object` which isn't the `int64` category expected. 

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

Since it is not a numerical value, it will not show up in our summary statistics if we do `describe()`:

```{python}
cereal.describe()
```
If we attempt to sum the column, we get a concatenation of the column:

```{python}
cereal['calories'].sum()
```

We saw earlier that when we add strings, they concatenate together. 


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

To go forward with any analysis, we are going to have to convert it to a numeric value. Luckily, there is an easy way to do it using verb `astype()`:

```{python}
cereal = cereal.assign(calories=cereal['calories'].astype('int'))
cereal.head(3)
```
We simply assign the column back to the same name but as dtype `int`.


```{python}
cereal.dtypes
```
Great, it looks like we are back on track. 


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

```{python}
cereal.head(3)
```


If we take the sum of the column now we get the actual sum:

```{python}
cereal['calories'].sum()
```

And the mean caloric value make much more sense now: 

```{python}
cereal['calories'].mean()
```


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## object columns

What happens if we try to take summary statistics of some of the other columns?

```{python error=TRUE}
cereal['mfr_type'].mean()
```
Yikes! let's not take the mean of columns of dtype `object`. 

As we saw before, taking a `.sum()` of a column concatenates the values together:

```{python}
cereal['mfr_type'].sum()
```

What about the column of type `bool`? 


Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Bool

Since booleans adopt the values of 0 and 1 for True and False values respectively, we can take the sum of a column to obtain the total number of `True` values:

```{python}
cereal['hot'].sum()
```

`.mean()` works by suming up all the values and divides them by the total number of rows. 

In the case where the column is of dtype `bool`, since `True` has a value of 1 and `False` has a value of 0, the mean is calculated as the total number of `True` values divided by the total number of `True` and `False` values. This gives the proportion of `True` values over the total number of rows. 
```{python}
cereal['hot'].mean()
```

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

## Axis Operations 

We are quite familiar with taking the mean and sum of entire columns but there are times where we want the mean or sum of the values in a row. 

```{python}
cereal.head(2)
```

Perhaps we wanted the total grams of `protein`,`fiber`,`fat` and `carbo` for each cereal?
Remember when we discussed the argument `axis` in Module 3? We can use it in our operations as well. `axis=1`  refers to the calculation being done for a row, across multiple columns, whereas `axis=0` (which is the default for aggregation verbs) refers to the calculation for a column, across multiple rows.

```{python}
cereal.loc[:, 'protein': 'carbo'].sum(axis=1)
```

Although this produces the totals, we want it as an additional column in the dataframe. That means we will have to combine it with `.assign()`.

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

```{python}
cereal.loc[:, 'protein': 'carbo'].sum(axis=1)
```

Although this produces the totals for each row, we want it as an additional column in the dataframe. We will have to combine it with the `.assign()` verb.

```{python}
cereal = cereal.assign(total_pffc=cereal.loc[:, 'protein': 'carbo'].sum(axis=1))
cereal.head()
```

We can do the same syntax for calculating the mean over multiple columns too. 

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />
</audio></html>

---

# Letâ€™s practice what we learned!

Notes: Script here
<html>
<audio controls >
  <source src="/placeholder_audio.mp3" />